{"data":{"site":{"siteMetadata":{"author":{"name":"Henry Wu","contacts":{"twitter":"#"}},"disqusShortname":"","subtitle":"Coding and stuff.","title":"Dev Notes","url":"https://lumen.netlify.com"}},"markdownRemark":{"id":"b002fa93-f7db-5d1a-84b5-1bf539939fbf","html":"<p>A common requirement for mobile apps is building the app to target a specific environment or uses a specific API key for your production environment versus your test one. From Part III of the <a href=\"https://12factor.net/\">Twelve Factor App</a>:</p>\n<blockquote>\n<p>Store config in the environment</p>\n</blockquote>\n<p>While it’s certainly possible to accomplish the above with a package like <a href=\"https://github.com/luggit/react-native-config\"><code class=\"language-text\">react-native-config</code></a> or by storing the configuration in your code then determining whether it’s a release or debug build, there’s a way to accomplish this in React Native using <a href=\"https://facebook.github.io/react-native/docs/native-modules-setup\">Native Modules</a>. Here’s the very simple overview of how this works in React Native:</p>\n<div class=\"mermaid\">graph LR\nA[Load .env files] --> B[Build System]\nB -->C[Expose constants to JS]\nC --> D[Import NativeModules in app]</div>\n<p>I started my project with the <a href=\"https://facebook.github.io/react-native/docs/getting-started.html#the-react-native-cli\">React Native CLI</a> using <code class=\"language-text\">react-native init</code>.</p>\n<p>All of the code can be found here: <a href=\"https://github.com/v1zix/ReactNativePlayground\">https://github.com/v1zix/ReactNativePlayground</a></p>\n<p>In Part 1 I’m just going to go over how to expose build time constants to JavaScript and then use Native Modules to show them in the app.</p>\n<h2 id=\"native-modules-in-react-native\"><a href=\"#native-modules-in-react-native\" aria-label=\"native modules in react native permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Native Modules in React Native</h2>\n<p>To actually get access to our environment variables I’m going off of the React Native docs for using Native Modules. Native Modules are used to allow JavaScript to interact with the native platform. Generally it’s for interacting with platform APIs or writing higher performance code, but in this case the build systems on Android and iOS both have the ability to get build configuration values into native code. We can use this feature to get build configuration into our JavaScript code. Links to the Native Module guides:</p>\n<ul>\n<li><a href=\"https://facebook.github.io/react-native/docs/native-modules-ios\">iOS</a></li>\n<li><a href=\"https://facebook.github.io/react-native/docs/native-modules-android\">Android</a></li>\n</ul>\n<p>Both of the guides have information on using constants, but the iOS guide has a specific <a href=\"https://facebook.github.io/react-native/docs/native-modules-ios#exporting-constants\">section on exporting constants</a>. A nice part of exporting constants is that it’s only done at initialization so we don’t need to make a round-trip through the bridge. I’m going to use that part of the guide as a starter on how to get environment variables to JavaScript.</p>\n<h2 id=\"build-constants-in-ios\"><a href=\"#build-constants-in-ios\" aria-label=\"build constants in ios permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build Constants in iOS</h2>\n<p>To start we can use some of the build constants that come with our starter app, which are the version code and version name. These are going to be in <code class=\"language-text\">name-of-app/ios/name-of-app/Info.plist</code>. This file will be important because on iOS eventually the values in the <code class=\"language-text\">Info.plist</code> will be available in <a href=\"https://developer.apple.com/documentation/foundation/nsbundle/1410786-mainbundle\"><code class=\"language-text\">mainBundle</code></a>, which has a type of <a href=\"https://developer.apple.com/documentation/foundation/nsbundle\"><code class=\"language-text\">NSBundle</code></a>, when the app is built. In <code class=\"language-text\">Info.plist</code> it should have something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\">&lt;!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plist</span> <span class=\"token attr-name\">version</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dict</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- Omit some lines --></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>CFBundleShortVersionString<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>1.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>CFBundleSignature<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>????<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>CFBundleVersion<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">&lt;!-- Omit some lines --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dict</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plist</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Here’s the code that will expose these constants on the native side located in the directory <code class=\"language-text\">name-of-app/ios/</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token comment\">// ios/BuildConstants.h</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">ifndef</span> BuildConstants_h</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> BuildConstants_h</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">import</span> &lt;React/RCTBridgeModule.h></span>\n\n<span class=\"token keyword\">@interface</span> BuildConstants <span class=\"token punctuation\">:</span> NSObject <span class=\"token operator\">&lt;</span>RCTBridgeModule<span class=\"token operator\">></span>\n<span class=\"token keyword\">@end</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">endif</span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"objectivec\"><pre class=\"language-objectivec\"><code class=\"language-objectivec\"><span class=\"token comment\">// ios/BuildContants.m</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">import</span> &lt;Foundation/Foundation.h></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">import</span> \"BuildConstants.h\"</span>\n\n<span class=\"token keyword\">@implementation</span> BuildConstants\n\n<span class=\"token function\">RCT_EXPORT_MODULE</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>NSDictionary <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>constantsToExport\n<span class=\"token punctuation\">{</span>\n  NSString <span class=\"token operator\">*</span>versionCode <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>NSBundle mainBundle<span class=\"token punctuation\">]</span> objectForInfoDictionaryKey<span class=\"token punctuation\">:</span><span class=\"token string\">@\"CFBundleVersion\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  NSString <span class=\"token operator\">*</span>versionName <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>NSBundle mainBundle<span class=\"token punctuation\">]</span> objectForInfoDictionaryKey<span class=\"token punctuation\">:</span><span class=\"token string\">@\"CFBundleShortVersionString\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">@</span><span class=\"token punctuation\">{</span>\n           <span class=\"token string\">@\"versionCode\"</span><span class=\"token punctuation\">:</span> versionCode<span class=\"token punctuation\">,</span>\n           <span class=\"token string\">@\"versionName\"</span><span class=\"token punctuation\">:</span> versionName\n           <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>BOOL<span class=\"token punctuation\">)</span>requiresMainQueueSetup\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> YES<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// only do this if your module initialization relies on calling UIKit!</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">@end</span></code></pre></div>\n<p>This will export the constants to be available to JavaScript, but without actually importing them in our JavaScript nothing will change in the app itself. Note that the name of the module in your iOS native code should probably be the same as the name in Android for clarity and convenience. I’ve named the module <code class=\"language-text\">BuildConstants</code> here. I’ll go over the same process in Android then show how to use these values in the app.</p>\n<h2 id=\"build-constants-in-android\"><a href=\"#build-constants-in-android\" aria-label=\"build constants in android permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build Constants in Android</h2>\n<p>On Android there is no <code class=\"language-text\">Info.plist</code>, but instead it’s in <code class=\"language-text\">name-of-app/android/app/build.gradle</code>. In <code class=\"language-text\">android.defaultConfig</code> it should have something like this specificed for version code and version name:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"groovy\"><pre class=\"language-groovy\"><code class=\"language-groovy\">android <span class=\"token punctuation\">{</span>\n    compileSdkVersion rootProject<span class=\"token operator\">.</span>ext<span class=\"token operator\">.</span>compileSdkVersion\n\n    compileOptions <span class=\"token punctuation\">{</span>\n        sourceCompatibility JavaVersion<span class=\"token operator\">.</span>VERSION_1_8\n        targetCompatibility JavaVersion<span class=\"token operator\">.</span>VERSION_1_8\n    <span class=\"token punctuation\">}</span>\n\n    defaultConfig <span class=\"token punctuation\">{</span>\n        applicationId <span class=\"token string gstring\">\"com.yourappname\"</span>\n        minSdkVersion rootProject<span class=\"token operator\">.</span>ext<span class=\"token operator\">.</span>minSdkVersion\n        targetSdkVersion rootProject<span class=\"token operator\">.</span>ext<span class=\"token operator\">.</span>targetSdkVersion\n<span class=\"gatsby-highlight-code-line\">        versionCode <span class=\"token number\">1</span></span><span class=\"gatsby-highlight-code-line\">        versionName <span class=\"token string gstring\">\"1.0\"</span></span>    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// ...omitted the rest</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>When a build is completed on Android a Java file will be generated that exposes the constants given to Gradle. That file should be located here for a debug build: <code class=\"language-text\">name-of-app/android/app/build/generated/source/buildConfig/debug/com/name-of-app/BuildConfig.java</code></p>\n<p>Then we can import that Java file like any other. Here’s the code:</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// android/app/src/main/java/com/reactnativeplayground/constants/BuildConstantsModule.java</span>\n<span class=\"token keyword\">package</span> com<span class=\"token punctuation\">.</span>reactnativeplayground<span class=\"token punctuation\">.</span>constants<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>reactnativeplayground<span class=\"token punctuation\">.</span>BuildConfig<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>NativeModule<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>ReactApplicationContext<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>ReactContext<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>ReactContextBaseJavaModule<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>HashMap<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BuildConstantsModule</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ReactContextBaseJavaModule</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">BuildConstantsModule</span><span class=\"token punctuation\">(</span>ReactApplicationContext reactContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>reactContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> String <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"BuildConstants\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> Map<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>String<span class=\"token punctuation\">,</span> Object<span class=\"token punctuation\">></span></span> <span class=\"token function\">getConstants</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">final</span> Map<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>String<span class=\"token punctuation\">,</span> Object<span class=\"token punctuation\">></span></span> constants <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    constants<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"versionCode\"</span><span class=\"token punctuation\">,</span> BuildConfig<span class=\"token punctuation\">.</span>VERSION_CODE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    constants<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"versionName\"</span><span class=\"token punctuation\">,</span> BuildConfig<span class=\"token punctuation\">.</span>VERSION_NAME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> constants<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Note the <code class=\"language-text\">getName()</code> method above uses <code class=\"language-text\">BuildConstants</code> to match the name we’re using in the previous Objective-C code. This allows us to import <code class=\"language-text\">NativeModules.BuildConstants</code> once and have access to the same values on both platforms. We’ll see this in the next section.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// android/app/src/main/java/com/reactnativeplayground/constants/BuildConstantsPackage.java</span>\n<span class=\"token keyword\">package</span> com<span class=\"token punctuation\">.</span>reactnativeplayground<span class=\"token punctuation\">.</span>constants<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>ReactPackage<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>NativeModule<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>bridge<span class=\"token punctuation\">.</span>ReactApplicationContext<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>uimanager<span class=\"token punctuation\">.</span>ViewManager<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>ArrayList<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>List<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BuildConstantsPackage</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ReactPackage</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> List<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>ViewManager<span class=\"token punctuation\">></span></span> <span class=\"token function\">createViewManagers</span><span class=\"token punctuation\">(</span>ReactApplicationContext reactContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Collections<span class=\"token punctuation\">.</span><span class=\"token function\">emptyList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Override</span>\n  <span class=\"token keyword\">public</span> List<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>NativeModule<span class=\"token punctuation\">></span></span> <span class=\"token function\">createNativeModules</span><span class=\"token punctuation\">(</span>\n                              ReactApplicationContext reactContext<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    List<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>NativeModule<span class=\"token punctuation\">></span></span> modules <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    modules<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">BuildConstantsModule</span><span class=\"token punctuation\">(</span>reactContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> modules<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then we need to include this package in <code class=\"language-text\">MainApplication.java</code>:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>ReactPackage<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>react<span class=\"token punctuation\">.</span>shell<span class=\"token punctuation\">.</span>MainReactPackage<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>facebook<span class=\"token punctuation\">.</span>soloader<span class=\"token punctuation\">.</span>SoLoader<span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>reactnativeplayground<span class=\"token punctuation\">.</span>constants<span class=\"token punctuation\">.</span>BuildConstantsPackage<span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>Arrays<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>List<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MainApplication</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Application</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ReactApplication</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> ReactNativeHost mReactNativeHost <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReactNativeHost</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">getUseDeveloperSupport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> BuildConfig<span class=\"token punctuation\">.</span>DEBUG<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">protected</span> List<span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>ReactPackage<span class=\"token punctuation\">></span></span> <span class=\"token function\">getPackages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> Arrays<span class=\"token punctuation\">.</span><span class=\"token generics function\"><span class=\"token punctuation\">&lt;</span>ReactPackage<span class=\"token punctuation\">></span></span><span class=\"token function\">asList</span><span class=\"token punctuation\">(</span>\n          <span class=\"token keyword\">new</span> <span class=\"token class-name\">MainReactPackage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token keyword\">new</span> <span class=\"token class-name\">BuildConstantsPackage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></span>      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"import-build-constants-in-javascript\"><a href=\"#import-build-constants-in-javascript\" aria-label=\"import build constants in javascript permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Import Build Constants in JavaScript</h2>\n<p>Now we have to import <code class=\"language-text\">NativeModules</code> and use the build constants in the app. In the same directory as your <code class=\"language-text\">App.js</code> with the starter app create a file called <code class=\"language-text\">BuildConstantsExample.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> NativeModules <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-native'</span><span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> NativeModules<span class=\"token punctuation\">.</span>BuildConstants<span class=\"token punctuation\">;</span></code></pre></div>\n<p>You don’t actually need the file above since it’s just syntactic sugar but doing it that way we can use it to import it in <code class=\"language-text\">App.js</code> like this:</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Platform<span class=\"token punctuation\">,</span> StyleSheet<span class=\"token punctuation\">,</span> Text<span class=\"token punctuation\">,</span> View <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-native'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> BuildConstants <span class=\"token keyword\">from</span> <span class=\"token string\">'./BuildConstantsExample'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">const</span> instructions <span class=\"token operator\">=</span> Platform<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  ios<span class=\"token punctuation\">:</span> <span class=\"token string\">'Press Cmd+R to reload,\\n'</span> <span class=\"token operator\">+</span> <span class=\"token string\">'Cmd+D or shake for dev menu'</span><span class=\"token punctuation\">,</span>\n  android<span class=\"token punctuation\">:</span>\n    <span class=\"token string\">'Double tap R on your keyboard to reload,\\n'</span> <span class=\"token operator\">+</span>\n    <span class=\"token string\">'Shake or press menu button for dev menu'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ntype Props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Props</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>View</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Text</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>welcome<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Welcome to React Native!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Text</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Text</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">To get started, edit App.js</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Text</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Text</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>instructions<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Text</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Text</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Build constants below!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Text</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Text</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Version code: </span><span class=\"token punctuation\">{</span>BuildConstants<span class=\"token punctuation\">.</span>versionCode<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Text</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Text</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>instructions<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Version name: </span><span class=\"token punctuation\">{</span>BuildConstants<span class=\"token punctuation\">.</span>versionName<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Text</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>View</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now when you run the app, you should see the version code and version name appear:\n<img src=\"/media/ios-sim-2019-05-07-version-code-and-name-build-constants.png\" alt=\"React Native starter screen with build constants\"></p>\n<p>In Part 2, I’ll go over adding environment files to load these kinds of build constants into the build system and then using them in the app.</p>","fields":{"tagSlugs":["/tag/react-native/","/tag/fastlane/","/tag/twelve-factor-app/"]},"frontmatter":{"date":"2019-05-31T06:44:59.680Z","description":"Exporting build time constants on Android and iOS to JavaScript in React Native.","tags":["React Native","Fastlane","Twelve Factor App"],"title":"Twelve Factor App Config with fastlane in React Native - Part 1"}}},"pageContext":{"slug":"/posts/twelve-factor-app-config-with-fastlane-in-react-native-part-1/"}}